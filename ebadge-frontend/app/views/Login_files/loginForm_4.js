function validateLoginForm(b){if(isCancelled(b)){return true}else{var a;a=validateRequired(b)&&validateConfirmedBy(b)&&validateMaxLength(b)&&validateMask(b);return(a)}}(function(a){(function(b){(function(c){c.username={rules:{required:"The username cannot be empty."}};c.password={rules:{required:"The password cannot be empty."}};c.newPassword={rules:{confirmedBy:"The confirmation of the new password must be exactly the same as the new password."},variables:{confirmedBy:"confirmNewPassword"}};c.mobilePhoneNumber={rules:{required:"Mobile phone number is required.",maxlength:"Mobile phone number can not be greater than 100 characters.",mask:"Mobile phone number is invalid."},variables:{maxlength:"100",mask:new RegExp("^\\s*(?:\\+|00)\\s*(\\d+\\s*)+$")}};c.smsChallenge={rules:{required:"SMS text challenge is required."},variables:{}};c.radiusTokenSerialNumber={rules:{required:"The field for the token serial number is empty or contains invalid characters."},variables:{}};c.radiusTokenChallengeResponse={rules:{required:"The field for the token challenge code is empty or contains invalid characters."},variables:{}};c.tokenCramSerialNumber={rules:{required:"The DigiPass serial number is empty or contains invalid characters.",maxlength:"DigiPass serial number can not be greater than 30 characters.",mask:"DigiPass serial number is invalid."},variables:{maxlength:"30",mask:new RegExp("^\\s*T?\\s*[\\-\\d\\s]+$")}};c.tokenCramResponse={rules:{required:"The DigiPass response is empty or contains invalid characters.",maxlength:"null can not be greater than 20 characters."},variables:{maxlength:"20",mask:new RegExp("^\\d{1,20}$")}};c.deviceName={rules:{required:"'Device name' cannot remain empty."},variables:{}};c.pinCode={rules:{required:"The pin code cannot be empty."},variables:{}};c.oneTimePassword={rules:{required:"Your one-time password is invalid."},variables:{}}})(b.loginForm=b.loginForm||{})})(a.forms=a.forms||{})})(window.ECAS=window.ECAS||{});(function(){var c=document.forms.loginForm;var m=c.mobilePhoneNumber;if(m){m.onkeypress=function(n){return handleInputKeyPressed(n,this,new RegExp("[0-9\\+\\s]"))};function e(n){return n.length===0||new RegExp("^\\s*\\+?[0-9\\s]*$").test(n)}m.onkeydown=function(n){if(e(this.value)){this.valueOnKeyDown=this.value}return true};var h=function(o){var n=e(this.value);if(n){this.valueOnKeyDown=this.value}else{if(isDefined(this.valueOnKeyDown)){this.value=this.valueOnKeyDown}}return n};m.oninput=h;m.onkeyup=h}var d=c.smsChallenge;if(d){d.onkeypress=function(n){return handleInputKeyPressed(n,this,new RegExp("[0-9A-Za-z\\-]"))};splitInputToMultiBox(d,3,3,"-","sms_challenge")}var k=c.radiusTokenSerialNumber;if(k){k.onkeypress=function(n){return handleInputKeyPressed(n,this,new RegExp("[\\-0-9T]"))}}var l=c.radiusTokenChallengeResponse;if(l){l.onkeypress=function(n){return handleInputKeyPressed(n,this,new RegExp("[0-9]"))}}var b=c.tokenCramSerialNumber;if(b){b.onkeypress=function(n){return handleInputKeyPressed(n,this,new RegExp("[\\-\\d\\s]"))};function g(n){return n.length===0||new RegExp("^\\s*T?[\\-\\d\\s]*$").test(n)}b.onkeydown=function(n){if(g(this.value)){this.valueOnKeyDown=this.value}return true};var h=function(o){var n=g(this.value);if(n){this.valueOnKeyDown=this.value}else{if(isDefined(this.valueOnKeyDown)){this.value=this.valueOnKeyDown}}return n};b.oninput=h;b.onkeyup=h}var i=c.tokenCramResponse;if(i){i.onkeypress=function(n){return handleInputKeyPressed(n,this,new RegExp("\\d"))};splitInputToMultiBox(i,4,3,"-","token_cram_response")}var f=c.deviceName;if(f){f.onkeypress=function(n){return handleInputKeyPressed(n,this,new RegExp("[A-Za-z0-9\\s\\._-]"))}}var j=c.pinCode;if(j){j.onkeypress=function(n){return handleInputKeyPressed(n,this,new RegExp("[A-Za-z0-9\\s\\._-]"))}}var a=c.oneTimePassword;if(a){a.onkeypress=function(n){return handleInputKeyPressed(n,this,new RegExp("[0-9\\s-]"))}}})();(function(){var d=document.forms.loginForm;d.data={clicks:0,cancelled:false};if(d.className&&d.className.length>0){d.className+=" focusable "}else{d.className="focusable"}var e=getCancelButtons(d);for(var c=0;c<e.length;c++){e[c].onclick=function(g){this.form.data.cancelled=true}}var f=getConfirmationFields(d);for(var b=0;b<f.length;b++){f[b].onpaste=function(g){return false}}var a=d.onsubmit;d.onsubmit=function(){return validateLoginForm(this)&&(a===null?true:a())&&++(this.data.clicks)===1}})();